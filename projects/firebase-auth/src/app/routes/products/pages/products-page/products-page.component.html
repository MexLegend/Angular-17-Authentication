<section class="flex flex-col gap-8 items-center justify-center mt-8 w-full">
  <div class="flex w-full items-center justify-end">
    <app-button label="Create product" (clickAction)="createProduct()">
      <span class="text-3xl leading-none font-medium pb-1">+</span>
    </app-button>
  </div>
  <article
    class="flex flex-col gap-6 rounded-2xl shadow-lg py-6 border items-center w-full"
  >
    <table class="w-full h-full table-auto">
      <thead class="h-10 px-6 border-b [&>th]:text-left">
        <th class="pl-6">Id</th>
        <th>Image</th>
        <th>Title</th>
        <th>Category</th>
        <th>Price</th>
        <th class="pr-6">Actions</th>
      </thead>
      <tbody class="[&>tr]:text-left [&>tr]:h-14">
        @if (!$isLoadingProducts()) { 
          @for (product of $products(); track
          product.id) {
          <tr 
            class="cursor-pointer transition duration-200 hover:bg-slate-100" 
            (click)="productQuickView(product)">
            <td class="w-20 text-sm pl-6">{{ product.id }}</td>
            <td class="px-3">
              <figure class="relative size-12 rounded-lg">
                <img 
                  class="object-contain" 
                  ngSrc="{{product.image}}" 
                  alt="product-img-{{product.title}}" 
                  priority 
                  fill
                >
              </figure>
            </td>
            <td>{{ product.title }}</td>
            <td>{{ product.category }}</td>
            <td>{{ product.price | currency }}</td>
            <td class="pr-6">
              <div class="flex justify-center items-center">
                <button 
                  mat-icon-button 
                  [matMenuTriggerFor]="menu" 
                  aria-label="Example icon-button with a menu"
                  class="flex items-center justify-center p-2 rounded-full transition duration-200 hover:bg-primary hover:text-white active:scale-95"
                  (click)="$event.stopPropagation()"
                  >
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                  <button 
                    mat-menu-item
                    class="flex items-center justify-center p-2 transition duration-200"
                    (click)="updateProductById(product.id)"
                    >
                    <mat-icon>share</mat-icon>
                    <span>Publish</span>
                  </button>
                  <button 
                    mat-menu-item
                    class="flex items-center justify-center p-2 transition duration-200 active:scale-95"
                    (click)="updateProductById(product.id)"
                    >
                    <mat-icon>edit</mat-icon>
                    <span>Edit</span>
                  </button>
                  <button 
                    mat-menu-item
                    class="flex items-center justify-center p-2 transition duration-200 active:scale-95"
                    (click)="deleteProductById(product.id)"
                    >
                    <mat-icon>delete</mat-icon>
                    <span>Delete</span>
                  </button>
                </mat-menu>
              </div>
            </td>
          </tr>
          } @empty {
          <tr class="h-36 text-center">
            <td colspan="6">
              <div class="flex flex-col items-center justify-center gap-4 w-full">
                <p>The product list is empty</p>
                <app-button
                  label="Create product"
                  (clickAction)="createProduct()"
                />
              </div>
            </td>
          </tr>
          } 
        } @else {
        <tr class="!h-36 text-center">
          <td colspan="6">
            <div class="flex flex-col items-center justify-center w-full">
              <app-loading-icon class="animate-spin" [size]="40" />
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </article>
</section>

<button (click)="createProduct()"></button>
